
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Parley Validation Demo</title>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.30.1/moment.min.js"></script>
  <!--<script src="https://cdn.jsdelivr.net/npm/parsleyjs@2.9.2/dist/parsley.js"></script>-->
  <link href="https://cdn.jsdelivr.net/npm/parsleyjs@2.9.2/src/parsley.css" rel="stylesheet">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/selectize@0.12.6/dist/js/standalone/selectize.min.js" integrity="sha256-+C0A5Ilqmu4QcSPxrlGpaZxJ04VjsRjKu+G82kl5UJk=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/selectize@0.12.6/dist/css/selectize.bootstrap3.min.css">

    <style>

    .bs-callout {
      padding: 20px;
      margin: 20px 0;
      border: 1px solid #eee;
      border-left-width: 5px;
      border-radius: 3px;
    }
    .bs-callout-info {
      border-left-color: #5bc0de;
    }
    .bs-callout-warning {
      border-left-color: #f0ad4e;
    }
    .hidden {
      display: none;
    }
    fieldset.parsley-error, p.parsley-error , .selectize-control.parsley-error > .selectize-input {
        color: #B94A48;
        background-color: #F2DEDE;
        border: 1px solid #EED3D7;
    }
    fieldset.parsley-success {
        box-shadow: 0 0px 3px #468847;
    }

    .parsley-errors-list > [data-success] {
        color: #468847;
    }
    @keyframes parsley-glow {
        0%   { box-shadow: 0 0 0 rgba(255, 0, 0, 0); }
        25%  { box-shadow: 0 0 8px rgba(255, 0, 0, 0.6); }
        50%  { box-shadow: 0 0 12px rgba(255, 0, 0, 0.8); }
        75%  { box-shadow: 0 0 8px rgba(255, 0, 0, 0.6); }
        100% { box-shadow: 0 0 0 rgba(255, 0, 0, 0); }
    }

    .parsley-glow {
        animation: parsley-glow 1.5s ease-out;
    }


    [type=checkbox].filled-in {
        position: absolute;
        opacity: 0;
        pointer-events: none;
    }
    [type=checkbox].filled-in+span {
        position: relative;
        padding-left: 35px;
        cursor: pointer;
        display: inline-block;
        height: 25px;
        line-height: 25px;
        user-select: none;
    }
    [type=checkbox].filled-in+span:not(.lever):after {
        border-radius: 2px
    }

    [type=checkbox].filled-in+span:not(.lever):before,[type=checkbox].filled-in+span:not(.lever):after {
        content: "";
        left: 0;
        position: absolute;
        transition: border .25s,background-color .25s,width .2s .1s,height .2s .1s,top .2s .1s,left .2s .1s;
        z-index: 1
    }

    [type=checkbox].filled-in:not(:checked)+span:before {
        width: 0;
        height: 0;
        border: 3px solid rgba(0,0,0,0);
        left: 6px;
        top: 10px;
        transform: rotateZ(37deg);
        transform-origin: 100% 100%
    }

    [type=checkbox].filled-in:not(:checked)+span:after {
        height: 20px;
        width: 20px;
        background-color: rgba(0,0,0,0);
        border: 2px solid #5a5a5a;
        top: 0px;
        z-index: 0
    }

    [type=checkbox].filled-in:checked+span:before {
        top: 0;
        left: 1px;
        width: 8px;
        height: 13px;
        border-top: 2px solid rgba(0,0,0,0);
        border-left: 2px solid rgba(0,0,0,0);
        border-right: 2px solid #fff;
        border-bottom: 2px solid #fff;
        transform: rotateZ(37deg);
        transform-origin: 100% 100%
    }

    [type=checkbox].filled-in:checked+span:after {
        top: 0;
        width: 20px;
        height: 20px;
        border: 2px solid black;
        background-color: black;
        z-index: 0
    }

</style>
</head>
<body>
<div class="container">
  <h2>Parley Validation Example</h2>

  <div class="bs-callout bs-callout-warning hidden">
    <h4>Oh snap!</h4>
    <p>This form seems to be invalid :(</p>
  </div>

  <div class="bs-callout bs-callout-info hidden">
    <h4>Yay!</h4>
    <p>Everything seems to be ok :)</p>
  </div>

    <form id="demo-form" data-parsley-validate>

        <fieldset class="row" data-parsley-unique-customer data-success-message="Yes, the name is not a duplicate!">
            <div class="col-md-6 mb-3">
                <label for="firstname">Fistname * :</label>
                <input type="text" class="form-control" name="form[firstname]" required
                       minlength="3"
                       data-parsley-maxlength="20"
                       data-parsley-trigger="input paste change"
                       data-parsley-minlength-message="Faite un effort, au moins %s lettres:-)"
                       data-parsley-errors-container="#my-container"
                       data-success-message="Looks good with value `%s` ðŸŽ‰"
                >
                <div id="my-container"></div>
            </div>
            <div class="col-md-6 mb-3">
                <label for="lastname">Lastname * :</label>
                <input type="text" class="form-control" name="form[lastname]" required minlength="3" maxlength="20" data-parsley-pattern="^[a-zA-ZÃ€-Ã¿' -]+$">
            </div>
        </fieldset>

        <div class="row" data-parsley-minrequired="1" data-parsley-minrequired-message="Veuillez renseigner au moins l'adresse email ou le numÃ©ro de tÃ©lÃ©phone.">
            <div class="col-md-6 mb-3">
                <label for="email" class="form-label">Email * :</label>
                <input type="email" id="email" class="form-control" name="form[email]">
            </div>
            <div class="col-md-6 mb-3">
                <label for="tel" class="form-label">Phone * :</label>
                <input type="tel" id="tel" class="form-control" name="form[tel]">
            </div>
        </div>

        <div class="row" style="display: none">
            <div class="col-md-6 mb-3">
                <label for="integer" class="form-label">Integer input * :</label>
                <input type="number" id="integer" class="form-control" name="form[integer]" data-parsley-type="integer" required>
            </div>
            <div class="col-md-6 mb-3">
                <label for="digits" class="form-label">Digits :</label>
                <input type="number" id="digits" class="form-control" name="form[digits]" data-parsley-type="digits">
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="date" class="form-label">Date input * :</label>
                <input type="date" id="date" class="form-control" name="form[date]" required>
            </div>
            <div class="col-md-6 mb-3">
                <label for="datestring" class="form-label">Date input * :</label>
                <input type="text" id="datestring" class="form-control" name="form[datestring]" data-parsley-date="DD.MM.YYYY" data-datemin="01/02/2020" data-datemax="01/02/2025" data-parsley-trigger="change">
                <!--
                <label for="range" class="form-label">Range :</label>
                <input type="range" id="range" class="form-control" name="form[range]" min="0" max="100" step="10">
                -->
            </div>
        </div>

        <div class="row">
            <!-- First half of the row -->
            <div class="col-md-6 mb-3">
                <div class="row">
                    <!-- VAT input: 8/12 width -->
                    <div class="col-md-8">
                        <label for="vat" class="form-label">VAT input *:</label>
                        <input type="text" id="vat" class="form-control"
                               name="form[vat]"
                               data-parsley-required="true"
                               data-parsley-validate-if="#isCompany">
                    </div>

                    <!-- Checkbox: 4/12 width -->
                    <div class="col-md-4">
                        <div class="d-flex flex-column">
                            <label class="form-check-label mb-1" for="isCompany">Is company?</label>
                            <input type="checkbox" id="isCompany" class="form-check-input" style="display: flex; flex-direction: column;">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Second half (you can leave empty or add more inputs) -->
            <div class="col-md-6 mb-3">
                <p>
                    <label>
                        <input type="checkbox" name="form[checkbox]" value="1" class="filled-in">
                        <span>J'accepte les Newsletters</span>
                    </label>
                </p>
            </div>
        </div>


        <p>
            <label for="message">Message (20 chars min, 100 max) :</label>
            <textarea id="message" class="form-control" name="form[message]" data-parsley-trigger="keyup" data-parsley-minlength="20" data-parsley-maxlength="100" data-parsley-minlength-message="Come on! You need to enter at least a 20 character comment.." data-parsley-validation-threshold="10"></textarea>
        </p>

        <label for="contactMethod">Preferred Contact Method *:</label>
        <p data-parsley-required>
            Email: <input type="radio" name="form[contactMethod]" id="contactMethodEmail" value="Email" >
            Phone: <input type="radio" name="form[contactMethod]" id="contactMethodPhone" value="Phone">
        </p>

        <label for="hobbies">Hobbies (Optional, but 2 minimum):</label>
        <p data-parsley-mincheck="2" data-parsley-check="[2, 3]">
            Skiing <input type="checkbox" name="form[hobbies][]" id="hobby1" value="ski"><br>
            Running <input type="checkbox" name="form[hobbies][]" id="hobby2" value="run"><br>
            Eating <input type="checkbox" name="form[hobbies][]" id="hobby3" value="eat"><br>
            Sleeping <input type="checkbox" name="form[hobbies][]" id="hobby4" value="sleep"><br>
            Reading <input type="checkbox" name="form[hobbies][]" id="hobby5" value="read"><br>
            Coding <input type="checkbox" name="form[hobbies][]" id="hobby6" value="code"><br>
        </p>

        <p>
            <label for="heard">Heard about us via *:</label>
            <select id="heard" name="form[heard]" required="">
                <option value="">Choose..</option>
                <option value="press">Press</option>
                <option value="net">Internet</option>
                <option value="mouth">Word of mouth</option>
                <option value="other">Other..</option>
            </select>
        </p>

        <p>
            <label for="select">Selectize *:</label>
            <select id="select" name="form[select]" required="" data-parsley-required="">

            </select>
        </p>

        <br>
        <input type="submit" class="btn btn-default" value="validate">

    </form>
    <br>
    <hr>
    <br>

</div>

<script>
    window.FiddoPluginName = 'Parsley';
    window.ParsleyConfig = {
        debug : true,
        autoBind : true
    }
</script>
    <script src="fiddo.bundle.js"></script>
<script src="fiddo.extra-validators.js"></script>

<script>
$(function () {

    $("#select").selectize({
        valueField: "email",
        labelField: "name",
        searchField: ["name", "email"],
        options: [
            { email: "selectize@risadams.com", name: "Ris Adams" },
            { email: "someone@gmail.com", name: "Someone" },
            { email: "someone-else@yahoo.com", name: "Someone Else" },
        ],
    });
    /*
    const $select = $("#select");
    // 1) jQuery style: listen to change on the original select
    $select.on("change", function () {
        console.log("Selected (jQuery change):", $(this).val());
    });
    // 2) Or, use Selectizeâ€™s own API
    const selectize = $select[0].selectize;
    selectize.on("change", function (value) {
        console.log("Selected (Selectize API):", value);
    });*/

    Parsley.addValidator('uniqueCustomer', {
        url: 'http://localhost',
        message: "Veuillez entrez un customer unique",
        group : true
    });

    const parsley = $('#demo-form').parsley();
    const $form = parsley.$element;
    $form.on('field:validated', function() {
        var ok = $('.parsley-error').length === 0;
        $('.bs-callout-info').toggleClass('hidden', !ok);
        $('.bs-callout-warning').toggleClass('hidden', ok);
  }).on('form:submit', function() {
    alert('Form submitted !');
    return false;
  });

    // Simulate AJAX validator locally
    $.ajax = function(options) {
        const dfd = $.Deferred();

        setTimeout(() => {
            const value = options.data?.value;
            let isValid = false;

            if (Array.isArray(value)) {
                const [first, second] = value.map(v => String(v).toLowerCase());
                isValid = first === 'john' && second === 'dooe';
            } else {
                isValid = String(value).toLowerCase() === 'valid';
            }

            // pick textStatus
            const textStatus = isValid ? "success" : "error";

            // minimal jqXHR stub
            const jqXHR = {
                readyState: 4,
                status: isValid ? 200 : 422,
                statusText: textStatus,
                responseJSON: { valid: isValid },
                getResponseHeader: () => null,
                getAllResponseHeaders: () => "",
            };

            // resolve with the three jQuery-style args
            dfd.resolve({ valid: isValid }, textStatus, jqXHR);
        }, 500);

        return dfd.promise();
    };
});


</script>
</body>
</html>
